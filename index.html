<!--
    | Encoding: UTF-8
    | URL: https://github.com/BlueSedDragon/abc
    | License: GPLv3 or later
-->

<!DOCTYPE HTML>

<html>

<head>
    <title>ABColor</title>
    <meta charset='utf-8' />
    <script type='text/javascript' src='./aes.js'></script>
    <script type='text/javascript' src='./hash.js'></script>
    <script type='text/javascript' src='./main.js'></script>
</head>

<body>
    <div style='text-align:center;'>
        <h1>ABColor (Version 1.531)</h1>

        <span>
            License:
            <a href='./LICENSE.txt'>
                GNU GPL Version 3.0</a> or any later version.<br />
        </span>

        <span>
            URL:
            <a href='https://github.com/BlueSedDragon/abc'>https://github.com/BlueSedDragon/abc</a>
        </span>

        <hr />
    </div>

    <noscript>
        <span style='color:red;'>注意：JavaScript 无法运行，此页面的功能无法使用。</span><br />
        您可以试试：
        <ul>
            <li>开启浏览器的 JavaScript 功能。</li>
            <li>升级浏览器版本。</li>
            <li>使用其他浏览器浏览本页。</li>
        </ul>
        <hr /><br />
    </noscript>
    <div id='test'>
        <span style='color:red;'>注意：您的浏览器不支持某些 JavaScript 特性（可使用 F12 查看错误信息），此页面的功能无法使用。</span><br />

        <div>
            提示：
            <ul>
                <li>如果是在线浏览，则可能是 JavaScript 未成功加载（偶发情况），可刷新页面试试。</li>
                <li>本网页在 Firefox 上测试通过，其他浏览器未测试，因此不保证其它浏览器的兼容性。</li>
            </ul>
        </div>

        <div>
            您可以试试：
            <ul>
                <li>升级浏览器版本。</li>
                <li>使用其他浏览器浏览本页。</li>
            </ul>
        </div>

        <br />

        以下是本程序所需要的 JavaScript 特性：
        <ul>
            <li>var</li>
            <li>let</li>
            <li>``</li>
            <li>[...$var]</li>
            <li>for-count</li>
            <li>for-in</li>
            <li>for-of</li>
            <li>Uint8Array()</li>
            <li>encodeURI()</li>
        </ul>
        <hr /><br />
    </div>

    <div id='gen-table'>
        <h2>第一步：生成字符集</h2>


        得到字符集的方法：随便从哪个网站上找一段文字复制即可，程序会自动提取文字中不重复的 CJK 字符（不包含标点符号）来作为字符集。<br />
        字符集的作用：它可以用来建立一个映射，该映射可用来表示任意的二进制数据（0x00 ~ 0xFF）。<br />
        字符集的位置：在 "当前的字符集" 下方，以 "[" 开始，以 "]" 结束。<br />
        保存字符集的方法：可将字符集保存到本地文件，然后在每次使用时粘贴到下方的框中。<br />
        <span style='color:red;'>注意：请使用 "随机排序" 功能打乱顺序以防止您的字符集与他人相同或相似。</span><br />
        <br />

        输入或粘贴一段文字以生成字符集：<br />
        （内置字符集：
        <a href='javascript:(void char_builtin(7));'>颜色</a> |
        <a href='javascript:(void char_builtin(5));'>虚词</a> |
        <a href='javascript:(void char_builtin(8));'>调料</a> |
        <a href='javascript:(void char_builtin(1));'>顺序</a> |
        <a href='javascript:(void char_builtin(10));'>单位</a> |
        <a href='javascript:(void char_builtin(6));'>方位</a> |
        <a href='javascript:(void char_builtin(9));'>元素</a> |
        <a href='javascript:(void char_builtin(0));'>文言文</a>
        ）<br />
        <textarea id='gen-table-body' style='width:100%;height:200px;font-size:xx-large;'></textarea><br />
        <input style='font-size:xx-large;' type='button' value='生成' onclick='table_get();' /><br /><br />

        <div id='gen-table-display'>
            当前的字符集（<a href='javascript:(void table_random());'>随机排序</a>）：<br />
            [<span id='gen-table-display-body'>N/A</span>]<br /><br />

            字符集个数：<span id='gen-table-display-count'>N/A</span>个。<br />
            <span id='gen-table-display-info'></span>
        </div>
    </div>
    <hr />
    <div id='code'>
        <h2>第二步：编码/解码</h2>
        Q: 编码方式是什么？<br />
        A: 编码方式是一种排序方式。<br />
        <ul>
            <li>Base16 是用十六个字符来分别表示 0x0 ~ 0xF，然后用两个字符来表示一个字节。</li>
            <li>Base256 则是用 256 个字符来分别表示 0x00 ~ 0xFF，这样就只需要用一个字符来表示一个字节。</li>
        </ul>
        所以，假设有一种编码方式为 Base<i>N</i>，则字符集的数量必须大于或等于 <i>N</i>。<br /><br />

        编码方式：<select id='code-mode' onchange='base_get(1);'>
            <option value='16'>Base16</option>
            <option value='256'>Base256</option>
        </select><br />

        <br />

        加密方式：<select id='crypt-mode' onchange='(function(){
            // to hidden crypt option if no encryption.
            var object = document.getElementById("crypt-option");
            if(get_crypt_mode() !== "none") object.style.display = "inline";
            else object.style.display = "none";
        })();'>
            <option value='aes-256-ctr'>有加密（AES-256-CTR）</option>
            <option value='none'>无加密</option>
        </select><br />

        <div id='crypt-option'>
            加密密码：<input id='crypt-password' type='password' /><br />

            IV 长度（范围：<span id='crypt-iv-range'></span>）：
            <input id='crypt-iv-length' type='text' value='32' style='width:3vw;' /><br />
        </div>
        <br />

        输入：
        <textarea id='io-input' style='width:100%;height:35vh;font-size:xx-large;'></textarea>
        <input style='font-size:xx-large;' type='button' value='编码' onclick='main(0);' />
        <input style='font-size:xx-large;' type='button' value='解码' onclick='main(1);' />
        <br /><br />

        输出：
        <textarea id='io-output' style='width:100%;height:35vh;font-size:xx-large;' readonly='readonly'></textarea>
        <br />
    </div>
    <hr />
    <div id='sub'>
        <h2>附录</h2>
        (本区域供调试使用 | This area is used for DEBUG.)<br /><br />
        Blacklist Check (format: JSON): <br />
        <textarea id='sub-test-1' style='width:100%;height:100px;'></textarea><br />
        <input type='button' value='Submit' onclick='(function(){
            var json = document.getElementById("sub-test-1").value;
            var data = JSON.parse(json);
            alert(JSON.stringify(char_test(data)));
        })();' />
        <hr />

        <a href='javascript:undefined;' onclick='(function(){
            var t;
            var d = String(Math.random()).repeat(1000);

            t = Date.now();window.sha256(d);t = (Date.now() - t);alert(`sha256() first: ${t} millisecond`);
            t = Date.now();window.sha256(d);t = (Date.now() - t);alert(`sha256() two: ${t} millisecond`);

            t = Date.now();window.sha256_cached(d); t = (Date.now() - t);alert(`sha256_cached() first: ${t} millisecond`);
            t = Date.now();window.sha256_cached(d); t = (Date.now() - t);alert(`sha256_cached() two: ${t} millisecond`);
        })();'>Test Hash Time</a>

        <br />

        <a href='javascript:undefined;' onclick='(function(){
            var c = 0;
            for(let a of char){
                let t = [];
                for(let b of char){
                    c += 1;
                    t.push(`${a}${b} (${c})\n`);
                }
                t = t.join("");
                alert(t);
            }
        })();'>All Possible</a><br />

        <a href='javascript:undefined;' onclick='(function(){
                var i = document.getElementById("io-input");
                var o = document.getElementById("io-output");

                i = i.value;
                o = o.value;

                i = i.length;
                o = o.length;


                var m = 100 / (i / o);

                alert(`Input Length: ${i}\nOutput Length: ${o}\n\n${m}%`);
        })();'>Size of I/O</a>
    </div>
</body>

</html>